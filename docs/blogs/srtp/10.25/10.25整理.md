## 2023 / 10 / 25 总结

### 与 baseline 的比对

此部分成图片的 `content` 均为：

<center>
    <img src="./10.25整理.assets/tun_1.jpg" alt="tun_1" style="zoom:33%;" />
</center>

`concept` 图片如下：

|               1                |                   2                   |                 3                  |                   4                   |
| :----------------------------: | :-----------------------------------: | :--------------------------------: | :-----------------------------------: |
| ![](./10.25整理.assets/p2.png) | ![](./10.25整理.assets/dragonite.png) | ![](./10.25整理.assets/lion_1.jpg) | ![](./10.25整理.assets/cheetah_2.jpg) |

|                  |                              1                               |                              2                               |                              3                               |                              4                               |
| :--------------: | :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|   **baseline**   | ![](./10.25整理.assets/__out__2.0_2023-10-22_18_29_56.852879.png) | ![](./10.25整理.assets/__out__2.0_2023-10-22_18_43_00.729432.png) | ![](./10.25整理.assets/__out__2.0_2023-10-22_18_45_08.642162.png) | ![](./10.25整理.assets/__out__2.0_2023-10-22_18_58_11.413580.png) |
|     **cfg**      | ![](./10.25整理.assets/__out__2.0_2023-10-22_19_32_55.520602.png) | ![](./10.25整理.assets/__out__2.0_2023-10-22_19_48_17.024886.png) | ![](./10.25整理.assets/__out__2.0_2023-10-22_20_03_41.883752.png) | ![](./10.25整理.assets/__out__2.0_2023-10-22_20_14_44.358096.png) |
| **cfg modified** | ![](./10.25整理.assets/__out__2.0_2023-10-22_19_09_40.901511.png) | ![](./10.25整理.assets/__out__2.0_2023-10-22_19_12_05.630705.png) | ![](./10.25整理.assets/__out__2.0_2023-10-22_19_14_31.202504.png) | ![](./10.25整理.assets/__out__2.0_2023-10-22_19_16_53.564795.png) |

`baseline` 使用 50 步 train_step，不使用 CFG 训练 target_embedding

`cfg` 使用 50 步 train_step，训练中有 0.5 的概率加上 cfg_loss

+  target 的计算公式为 $l2\_target = target + \frac{cfg\_ratio}{cfg\_ratio+1}(src\_pred-target)$，cfg_ratio = 2.0

可以观察到图片 1 的结果在色调上更加接近 concept。图片 2 在生成的精细程度上更高。图片 3 和图片 4 的生成效果差异不大，相对来说图片 4 略微更接近 concept。

`cfg modified` 使用 50 步 train_step，训练中有 0.5 的概率加上 cfg_loss

+  target 的计算公式为 $l2\_target = target + \frac{1}{cfg\_ratio+1}(src\_pred-target)$，cfg_ratio = 2.0

可以观察到图像 1 的生成质量得到了明显的提高，整体的扁平化风格更加明显。图片 2 的生成质量提升较多。出现了较为明显的毛发涂抹效果，包括眼睛部分，更为接近 concept 的风格。图片 3 图片 4 与 baseline 的差异不大，放大看之后可以发现图片的锐化得到了一定的改善。

### 不同 CFG 系数的样例生成

以下的 train_step 均为 1000。

#### 第一组

|                          concept                          |                           content                            |
| :-------------------------------------------------------: | :----------------------------------------------------------: |
| <img src="./10.25整理.assets/p2.png" style="zoom:50%;" /> | <img src="./10.25整理.assets/tun_1.jpg" style="zoom:50%;" /> |

|                   -1.0                    |                   0.0                    |                   1.0                    |                   2.0                    |                   3.0                    |                   7.5                    |
| :---------------------------------------: | :--------------------------------------: | :--------------------------------------: | :--------------------------------------: | :--------------------------------------: | :--------------------------------------: |
| ![](./10.25整理.assets/-1.0_tun_1_p2.png) | ![](./10.25整理.assets/0.0_tun_1_p2.png) | ![](./10.25整理.assets/1.0_tun_1_p2.png) | ![](./10.25整理.assets/2.0_tun_1_p2.png) | ![](./10.25整理.assets/3.0_tun_1_p2.png) | ![](./10.25整理.assets/7.5_tun_1_p2.png) |

#### 第二组

|                           concept                            |                           content                            |
| :----------------------------------------------------------: | :----------------------------------------------------------: |
| <img src="./10.25整理.assets/lion_1.jpg" style="zoom:50%;" /> | <img src="./10.25整理.assets/cheetah_2.jpg" style="zoom:50%;" /> |

|                       0.0                        |                       2.0                        |                       3.0                        |                       7.5                        |
| :----------------------------------------------: | :----------------------------------------------: | :----------------------------------------------: | :----------------------------------------------: |
| ![](./10.25整理.assets/0.0_cheetah_2_lion_1.png) | ![](./10.25整理.assets/2.0_cheetah_2_lion_1.png) | ![](./10.25整理.assets/3.0_cheetah_2_lion_1.png) | ![](./10.25整理.assets/7.5_cheetah_2_lion_1.png) |

### 第三组

|                           concept                            |                           content                            |
| :----------------------------------------------------------: | :----------------------------------------------------------: |
| <img src="./10.25整理.assets/lion_1.jpg" style="zoom:50%;" /> | <img src="./10.25整理.assets/tun_1.jpg" style="zoom:50%;" /> |

|                             0.0                              |                             1.0                              |                             7.5                              |
| :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
| <img src="./10.25整理.assets/0.0_tun_1_lion_1.png" style="zoom:33%;" /> | <img src="./10.25整理.assets/1.0_tun_1_lion_1.png" style="zoom:33%;" /> | <img src="./10.25整理.assets/7.5_tun_1_lion_1.png" style="zoom:33%;" /> |

### 第四组

|                           concept                            |                           content                            |
| :----------------------------------------------------------: | :----------------------------------------------------------: |
| <img src="./10.25整理.assets/cheetah_2.jpg" style="zoom:50%;" /> | <img src="./10.25整理.assets/tun_1.jpg" style="zoom:50%;" /> |

|                       -2.0                       |                       0.0                       | 2.0                                             |                       7.5                       |
| :----------------------------------------------: | :---------------------------------------------: | ----------------------------------------------- | :---------------------------------------------: |
| ![](./10.25整理.assets/-2.0_tun_1_cheetah_2.png) | ![](./10.25整理.assets/0.0_tun_1_cheetah_2.png) | ![](./10.25整理.assets/2.0_tun_1_cheetah_2.png) | ![](./10.25整理.assets/7.5_tun_1_cheetah_2.png) |

### 第五组

|                           concept                            |                           content                            |
| :----------------------------------------------------------: | :----------------------------------------------------------: |
| <img src="./10.25整理.assets/ref2.png" alt="ref2" style="zoom:50%;" /> | <img src="./10.25整理.assets/tun_1.jpg" style="zoom:50%;" /> |

|                             -1.0                             |                             0.0                              |
| :----------------------------------------------------------: | :----------------------------------------------------------: |
| <img src="./10.25整理.assets/-1.0_tun_1_dragonite.png" style="zoom:33%;" /> | <img src="./10.25整理.assets/0.0_tun_1_dragonite.png" style="zoom:33%;" /> |
